---
title: "Phonology of East Caucasian languages"
author: "G. Moroz"
output: html_document
bibliography: "bibliography.bib"
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# setwd("/home/agricolamz/work/materials/2021_caucasian_phonology")
library(lingtypology)
library(tidyverse)
df <- read_csv("database.csv")
# for maps
df %>% 
  mutate(lang = str_replace_all(lang, "Khwarshi", "Khwarshi-Inkhoqwari"),
         lang = str_replace_all(lang, "Dargwa", "Megeb")) ->
  df
```


## Introduction

There are a lot of work about phonology of indigenous languages of the Caucasus [@catford77; @smeets94a; @smeets94b; @alekseev01; @hewitt04; @grawunder17; @begus21; @boris21b; @boris21a; @koryakov21] and particular dedicated East Caucasian languages [@kk90]. There are also a lot of work on historical-comparative phonetics (S. M. Gasanova, G. Kh. Ibragimov, P. T. Magomedova, U. A. Meylanova, B. B. Talibov, S. M. Khaydakov, A. E. Alekseev, Ju. D. Desheriev, B. K. Gigineishvili, D. S. Imnaishvili, J. Nichols, S. L. Nikolayev, S. A. Starostin, A. S. Kasyan, N. A. Ardoteli, O. A. Mudrak, PUT HERE BIBTEX). Fortunately the amount of grammatical description of particular languages is increasing, so we have a lot of more new and detailed information about phonological inventories of particular villages and do not need to extropolate our knowledge of standard languages onto all villages, where the language is spoken. Even though we have a lot of works on different East Caucasian languages, in order to proceed with the analysis we still need a unified description of those inventories. We compiled the database of East Caucasian languages that can be downloaded here (add link). The database has the following variables:

* id -- unique id for each segment
* glottocode -- language identifier after Glottolog database [@hammarstrom21]
* lang -- language name
* idiom
* type
* value --- segment in IPA notation
* value_source --- segment as it was presented in the source
* annotation --- annotation of type of the segment (consonant vs. vowel)
* source --- bibtex entry of the source of the information
* page
* comment

As we discovered on average East Caucasian languages have more consonants and vowels then other languages of the world. The main reason for this are the folowing

* as other indigenous languages of the Caucasus all East Caucasian languages have **ejective consonants** (except Udi);
* as other indigenous languages of the Caucasus all East Caucasian languages have **uvular consonants**;
* Andic and Tsezic languages have **lateral obstruents**;
* **labialization**, gemination and fortis/lenis destinction is widespread across Dagestan;
* common among languages of the world triangle vowel system (*i*, *e*, *a*, *o*, *u*) is complicated with **nasalization** (mostly Andic and some Tsezic languages), **long vowels** (Nakh, Andic and Tsezic), **pharyngealisation** and **umlaut vowels** (on the South, Azerbaijanian influence?);
* more or less East Caucasian languages share the same inventory of sonorants (*r*, *l*, *m*, *n*, *j*, *w*) with rare exception for *w* in South Lezgian languages.

## Inventory size

Here is the map of inventory sizes of East Caucasian languages:

```{r}
df %>% 
  count(lang) ->
  for_map

map.feature(languages = for_map$lang,
            minichart = "pie",
            minichart.data = for_map$n,
            minichart.labels = TRUE,
            width = 3,
            tile = "Stamen.Terrain")
```

As we see inventory size are differe from `r min(range(for_map$n))` (Lezgian and Tsez) to `r max(range(for_map$n))` (Northern Akvakh). We can compare the obtained numbers with the PHOIBLE database [@phoible] which contains inventories of the languages of the world:

```{r}
ph <- phoible.feature()
set.seed(42)
ph %>% 
  count(language, inventoryid) %>% 
  group_by(language) %>% 
  sample_n(1) %>% 
  anti_join(for_map) %>% 
  ggplot(aes(n))+
  geom_histogram(data = for_map, aes(x = n, y = ..density..))+
  geom_density(size = 2, color = "red")+
  theme_minimal()+
  labs(x = "number of segments",
       subtitle = "Histogram of East Caucasian inventory sizes (in black)\nwith overlayed density function of inventory sizes of languages of the world (in red)")
```

As we can see, East Caucasian languages in general have generally big segment inventories comparing to the rest languages of the world (we removed East Caucasian languages from PHOIBLE before creating the density curve).


## Consonant inventory size

We can do the same comparison for the consonant inventories:

```{r}
df %>% 
  filter(segment_type == "consonant") %>% 
  count(lang) ->
  for_map

map.feature(languages = for_map$lang,
            minichart = "pie",
            minichart.data = for_map$n,
            minichart.labels = TRUE,
            width = 3,
            tile = "Stamen.Terrain")
```

As we see inventory size are differe from `r min(range(for_map$n))` (Budukh) to `r max(range(for_map$n))` (Northern Akvakh). We can compare the obtained numbers with the PHOIBLE database [@phoible]:

```{r}
set.seed(42)
ph %>% 
  filter(segmentclass == "consonant") %>% 
  count(language, inventoryid) %>% 
  group_by(language) %>% 
  sample_n(1) %>% 
  anti_join(for_map) %>% 
  ggplot(aes(n))+
  geom_histogram(data = for_map, aes(x = n, y = ..density..))+
  geom_density(size = 2, color = "red")+
  theme_minimal()+
  labs(x = "number of segments",
       subtitle = "Histogram of East Caucasian consonant inventory sizes (in black)\nwith overlayed density function of consonant inventory sizes of languages of the world (in red)")
```

As we can see, the majority of languages from PHOIBLE has less consonants then East Caucasian languages.

## Vowel inventory size

We can do the same comparison for the consonant inventories:

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  count(lang) ->
  for_map

map.feature(languages = for_map$lang,
            minichart = "pie",
            minichart.data = for_map$n,
            minichart.labels = TRUE,
            width = 3,
            tile = "Stamen.Terrain")
```

As we see inventory size are differe from `r min(range(for_map$n))` (Avar) to `r max(range(for_map$n))` (Bezhta). We can compare the obtained numbers with the PHOIBLE database [@phoible]:

```{r}
set.seed(42)
ph %>% 
  filter(segmentclass == "vowel") %>% 
  count(language, inventoryid) %>% 
  group_by(language) %>% 
  sample_n(1) %>% 
  anti_join(for_map) %>% 
  ggplot(aes(n))+
  geom_histogram(data = for_map, aes(x = n, y = ..density..))+
  geom_density(size = 2, color = "red")+
  theme_minimal()+
  labs(x = "number of segments",
       subtitle = "Histogram of East Caucasian vowel inventory sizes (in black)\nwith overlayed density function of vowel inventory sizes of languages of the world (in red)")
```

As we can see, even vowel inventory sizes of East Caucasian languages are bigger than the average.

## Labialization

```{r}
df %>% 
  mutate(lab = str_detect(segment, "ʷ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_lab = sum(lab),
            labialization = ifelse(n_lab > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, labialization, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/labialization.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$labialization,
            tile = "Stamen.Terrain")
```

Labialization is widely attested in East Caucasian languages, however there are some languages that lost this feature (e. g. in Budukh, [@talibov07]). Unfortunately, sometimes scholars do not put the whole list of labialised consonants attested in a language. After [@catford72] it is worth mentioning that there are several types of labialisation: 

* /w/-labialisation --- this kind of labialization is more or less independent of the main place of articulation. This kind of labialisation is typical for velar and uvular places fricatives and stops;
* /ɥ/-labialisation --- this kind of labialization is typical for pharyngeals. It looks like the tongue body is retracted (due to pharyngeal place of articulation) and raised, that results /ɥ/-like sound;
* /y/-labialisation --- this kind of labialization is typical only for post-alveolars in Abkhaz and Abaza (North Caucasian), but also may be a case for Tabasaran [@kibrik82: 7--8; @kk90: 337] and Aghul [@kk90: 338].

## Geminates/Fortis

```{r}
df %>% 
  filter(segment_type == "consonant") %>% 
  mutate(feature = str_detect(segment, "ː")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            geminates = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, geminates, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/geminates.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$geminates,
            tile = "Stamen.Terrain")
```

Geminated of fortis/lenis destinction attested through all branches of East Caucasian languages except Tsesic. Unfortunately some scholars understand this differently, so sometimes under this label aspirated vs unaspirated disctinction is used.

## Lateral obstruents

```{r}
df %>% 
  mutate(feature = str_detect(segment, "ɬ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            laterals = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, laterals, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/laterals.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$laterals,
            tile = "Stamen.Terrain")
```


Laterals is the clear feature of Andic and Tsezic languages, hover there is one Lezghian language, Archi, where they also were attested. In most cases lateral system is present by fricative ɬ and two affricates tɬ and tɬ'. Sometimes the subsystem even bigger when geminated version are present.

## Labial approximmant vs fricatives

```{r}
df %>% 
  mutate(feature = str_detect(segment, "v")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            labials = ifelse(n_feature > 0, "v", "w")) %>% 
  select(lang, language, idiom, type, labials, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/labials.csv", na = "")


map.feature(languages = for_map$lang,
            features = for_map$labials,
            tile = "Stamen.Terrain")
```

The most common labial sound in East Caucasian languages is bilabial **w** that is present in most languages, however in the South Dagestan approximant become a frecative **v**. I also visited the Dargwa village Ayalakab, where I witnessed the bilabial fricative realisation **β**.

## Pharyngealization

```{r}
df %>%  
  mutate(feature = str_detect(segment, "ˤ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            pharyngealization = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, pharyngealization, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/pharyngealization.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$pharyngealization,
            tile = "Stamen.Terrain")
```

Pharyngealization --- is a complex feature that phonetically reallised as a constriction in the pharynx or epiglottis zone. Different scholars used different strategy in describing locus of the pharyngealisation: sometimes it is analysed as a vowel feature [@forker13], sometimes as a consonant feature [@khalilova09] and sometimes as a suprasegmental feature [@kibrik1994a; @moroz19]. It is common that pharyngealisation spreads through the word, hovewer most researchers distinguish core pharyngealised syllable [@kibrik1994a; @talibov07; @moroz19; @belyayev21]. Everything become even more complicated since some East Caucasian languages developed two different types of pharyngealisation [e. g. @belyayev21]. As we can see from the map, pharyngealization is common for central and south Daghestan for languages of Dargic, Lak, Tsezic and Lezgian branches.

## Nasalized vowels

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  mutate(feature = str_detect(segment, "ⁿ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            nasalization = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, nasalization, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/nasalization.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$nasalization,
            tile = "Stamen.Terrain")
```

Nasalised vowels is a comon feature of Andic and Tsezic languages, hovewer some researchers report sporadic final **n**-delition that leads to development of nasalised vowels in other branches (e. g. Bezhta, [@talibov07]).

## Long vowels

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  mutate(feature = str_detect(segment, "ː")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            `long vowels` = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, `long vowels`, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/long_vowels.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$`long vowels`,
            tile = "Stamen.Terrain")
```


Long vowels are grouped in the North Dagestan, Chechnya and Ingushetia. It is not present in Avar and and South Dagestan. Hovewer there are some cases when they were reported as a result of some intervocal consonant delitions.

## Umlaut vowels

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  mutate(feature = str_detect(segment, "[yøæ]")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributer, date) %>% 
  summarise(n_feature = sum(feature),
            `umlaut vowels` = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, `umlaut vowels`, source, page, contributer, date) ->
  for_map

for_map %>% 
  ungroup() %>% 
  select(-lang) %>% 
  write_csv("for_dagatlas/umlaut_vowels.csv", na = "")

map.feature(languages = for_map$lang,
            features = for_map$`umlaut vowels`,
            tile = "Stamen.Terrain")
```

Umlaut vowels are present in the South Dagestan and in Nakh languages. I can speculatively propose that they historically developed from pharyngealisation, but this hypothesis needs to be accurately checked with shared lexicon.