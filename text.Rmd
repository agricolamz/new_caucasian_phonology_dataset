---
title: "On phonology of East Caucasian languages"
author: "G. Moroz"
output: 
  html_document: default
always_allow_html: true
bibliography: "bibliography.bib"
editor_options: 
  chunk_output_type: console
---

```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# setwd("/home/agricolamz/work/materials/2021_caucasian_phonology")
library(lingtypology)
library(tidyverse)
df <- read_csv("database.csv")
```


## Introduction

There are a lot of work about phonology of indigenous languages of the Caucasus [@catford77; @smeets94a; @smeets94b; @alekseev01; @hewitt04; @grawunder17; @begus21; @boris21b; @boris21a; @koryakov21] and particular dedicated East Caucasian languages [@kk90]. There are also a lot of work on historical-comparative phonetics [@bokarev60; @gudava64; @imnayshvili77; @akiev77; @gigineyshvili77; @talibov80; @bokarev81; @nikolayev94; @nichols03; @ardoteli09; @mudrak19; @mudrak20] and many others. Fortunately the amount of grammatical description of particular languages is increasing, so we have a lot of more new and detailed information about phonological inventories of particular villages and do not need to extrapolate our knowledge of standard languages onto all villages, where the language is spoken. Even though we have a lot of works on different East Caucasian languages, in order to proceed with the analysis we still need a unified description of those inventories. In order to solve this task, I compiled the database of East Caucasian languages that can be downloaded from [here](https://raw.githubusercontent.com/agricolamz/new_caucasian_phonology_dataset/master/database.csv). The database has the following variables:

* id -- unique id for each segment;
* glottocode -- language identifier after Glottolog database [@hammarstrom21];
* language -- language name;
* idiom;
* type;
* segment --- segment in IPA notation;
* segment_source --- segment as it was presented in the source;
* segment_type --- annotation of type of the segment (consonant, vowel or diphthong);
* source --- bibtex entry of the source of the information;
* page;
* comment;
* contributor;
* date -- date of the contribution.

The database is compiled from different sources and therefore some languages can be present multiple times: in some cases it is different idioms (e. g. Darwa dialects), in other cases it is different sources of the same languages (e. g. Khinalug).

On average East Caucasian languages (and other indigenous languages of the Caucasus) have more consonants and vowels then other languages of the world. The main reasons for this are the following

* as other indigenous languages of the Caucasus East Caucasian languages have **ejective consonants** (except Udi);
* as other indigenous languages of the Caucasus East Caucasian languages have **uvular consonants**;
* Andic and Tsezic languages have **lateral obstruents**;
* **labialization**, gemination and fortis/lenis destinction is widespread across Dagestan;
* common among languages of the world triangle vowel system (*i*, *e*, *a*, *o*, *u*) is complicated with **nasalization** (mostly Andic and some Tsezic languages), **long vowels** (Nakh, Andic and Tsezic), **pharyngealisation** and **umlaut vowels** (on the South, Azerbaijanian influence?).

In this introductory part of the atlas we will be focusing on inventory sizes, but there are also the following separate subchapters:

```{r, include=FALSE}
read_csv("merge_all_features.csv") %>% distinct(feature) %>% pull(feature) %>% str_c("* ", ., collapse =  " ")
```

* Number of contrasts in voiceless consonants 
* Presence of fortis/geminates 
* Presence of labialized consonants 
* Presence of laterals 
* Presence of long vowels 
* Presence of nasal vowels 
* Pharyngeal inventories
* Presence of pharyngealized segments
* Inventory of v-like consonants
* Presence of palatalized consonants 
* Presence of umlaut vowels 
* Presence of uvular voiced stop
* Presence of velar voiced fricative
* Presence of ejective pʼ
* Presence of ejective fricatives

## Inventory size

Here is the map of inventory sizes of East Caucasian languages:


```{r}
set.seed(42)
df %>% 
  distinct(lang, source, glottocode) %>% 
  group_by(lang) %>% 
  slice_sample(n = 1) %>% 
  mutate(filter_languages = TRUE) ->
  filter_for_maps
```

```{r}
df %>% 
  left_join(filter_for_maps) %>% 
  filter(filter_languages) %>% 
  count(lang, source, glottocode) ->
  for_map

map.feature(languages = for_map$lang,
            minichart = "pie",
            minichart.data = for_map$n,
            minichart.labels = TRUE,
            width = 3,
            tile = "Stamen.Terrain")
```

As we can see inventory size of languages in our dataset are ranged from `r min(range(for_map$n))` (Georgian and Kumyk) to `r max(range(for_map$n))` (Northern Akvakh). We can compare the obtained numbers with the PHOIBLE database [@phoible] which contains inventories of the languages of the world[^excludEA]:

[^excludEA]: Here and further performing such a comparison of our dataset and one, provided by PHOIBLE, arise a question: whether we need to exclude East Caucasian and non-indigenous languages of the Caucasus from the PHOIBLE subsample that we use? In this text we decided to exclude them for the sake of the comparability. However, groups that we get are far from to be comparable in the proper way: different language families are overrepresented in both groups; the dataset sizes are different (PHOIBLE's 2169 languages vs our dataset of 50 idioms) etc. For those who are against of the exclusion we assure that this operation changes shapes of the density plots that we obtained, but the change is extremely small. 

```{r download phoible, cache=TRUE}
ph <- phoible.feature(na.rm = FALSE)

set.seed(42)
ph %>% 
  distinct(language, inventoryid, glottocode) %>% 
  group_by(language) %>% 
  sample_n(1) %>% 
  anti_join(df, by = "glottocode") %>% 
  pull(inventoryid) ->
  ph_sample
```

```{r}
ph %>% 
  filter(inventoryid %in% ph_sample) %>% 
  count(language, inventoryid) %>% 
  ggplot(aes(n))+
  geom_density(data = for_map, aes(x = n))+
  geom_density(color = "red")+
  theme_minimal()+
  labs(x = "number of segments",
       subtitle = "Density functions of East Caucasian inventory sizes (in black)\nwith overlayed with density function of inventory sizes of languages of the world (in red)")
```

As we can see, East Caucasian languages in general have big segment inventories (with mean, median and mode near 60 segments) comparing to the rest languages of the world. A small peak around 40 can be explained by non-indigenous languages present in our dataset. From the next sections we will see that overall large inventories are mostly caused by large consonant inventories, but vowels and diphthongs also play a significant role.

### Consonant inventory size

We can do the same comparison for the consonant inventories:

```{r}
df %>% 
  left_join(filter_for_maps) %>% 
  filter(filter_languages,
         segment_type == "consonant") %>% 
  count(lang, source) ->
  for_map

map.feature(languages = for_map$lang,
            minichart = "pie",
            minichart.data = for_map$n,
            minichart.labels = TRUE,
            width = 3,
            tile = "Stamen.Terrain")
```

As we see inventory size are differe from `r min(range(for_map$n))` (Azerbaijani) to `r max(range(for_map$n))` (Northern Akvakh). We can compare the obtained numbers with the PHOIBLE database [@phoible]:

```{r}
set.seed(42)
ph %>% 
  filter(inventoryid %in% ph_sample,
         segmentclass == "consonant") %>% 
  count(language, inventoryid) %>% 
  ggplot(aes(n))+
  geom_density(data = for_map, aes(x = n))+
  geom_density(size = 1, color = "red")+
  theme_minimal()+
  labs(x = "number of consonant segments",
       subtitle = "Density of East Caucasian consonant inventory sizes (in black)\nwith overlayed density function of consonant inventory sizes of languages of the world (in red)")
```

As we can see, the majority of languages from PHOIBLE has less consonants then East Caucasian languages. This is result caused by different subsystems of East Caucasian languages like ejectives, labialized consonants, uvulars and post uvulars. More or less the same phonological profile can be found in other indigenous language family of the Caucasus --- North-East Caucasian languages with one of the world consonant champions Ubykh [@fenwick11: 16--17].

### Vowel inventory size

We can do the same comparison for the consonant inventories:

```{r}
df %>% 
  left_join(filter_for_maps) %>% 
  filter(filter_languages,
         segment_type == "vowel" | segment_type == "diphthong") %>% 
  count(lang, source) ->
  for_map

map.feature(languages = for_map$lang,
            minichart = "pie",
            minichart.data = for_map$n,
            minichart.labels = TRUE,
            width = 3,
            tile = "Stamen.Terrain")
```

As we see inventory size are differ from `r min(range(for_map$n))` (Avar) to `r max(range(for_map$n))` (Chechen). We can compare the obtained numbers with the PHOIBLE database [@phoible]:

```{r}
ph %>% 
  filter(segmentclass == "vowel",
         inventoryid %in% ph_sample) %>% 
  count(language, inventoryid) %>% 
  ggplot(aes(n))+
  geom_density(data = for_map, aes(x = n))+
  geom_density(size = 1, color = "red")+
  theme_minimal()+
  labs(x = "number of vowel or dipthong segments",
       subtitle = "Density of East Caucasian vowel and dipthong inventory sizes (in black)\nwith overlayed density function of vowel inventory sizes of languages of the world (in red)")
```

As we can see, even vowel/diphthong inventory sizes of East Caucasian languages are slightly bigger than the average language of the world. As expected PHOIBLE data reveal average vowel/diphthong inventory size around 5, while the East Caucasian dataset show the mean, median an mode around 10 vowels/diphthongs. Diphthongs are present only in Nakh languages and Hinuq [@forker13]. However it is worth mentioning that the distinction between diphthong and and combination of vowel and semivowels *j* and *w* is not clear in East Caucasian languages. There is a tendency to have closing diphthongs or combinations of vowel and semivowel in the end of the syllable (like *ai*/*aj*, *eu*/*ew*) and opening diphthongs or combinations of vowel and semivowel in the beginning of the syllable (like *ia*/*ja*, *ue*/*we*), and, as far as I know, there is no phonological difference between diphthongs and combinations of vowel and semivowel in any East Caucasian language. I can stipulate that Nakh scholars tend to describe those unites as diphthongs and Dagestanian scholars tend to describe them as combinations of vowel and semivowel.

## Contrasts in voiceless obstruents

The noticeable feature of all indigenous languages of the Caucasus is the presence of ejective consonants that usually present in most possible places of articulation (see chapter on ejective pʼ) and not restricted to obstruents, but also affricates (and sometimes fricatives, see chapter on ejective fricatives). This feature is so widespread that even non-indigenous languages of the Caucasus like Azerbaijani [@aslanov74; @daniell2021], Kumyk [@dmitriyev40: 32], Ossetic [@abaev64: 6] borrowed some ejective consonants due to the contact or a East Caucasian substrat. It is also worth mentioning that Udi, indigenous East Caucasian language, lost ejectives evidently because of the Azerbaijani and replaced them with non-aspirated obstruents.

Voiceless stops of all indigenous languages of the Caucasus tend to be slightly aspirated. In some languages there is even separate opposition of aspirated vs. non-aspirated (sometimes in Russian linguistic term *преруптивный* is used) stops: Udi, Lezgian, Khinalug.


## Pharyngeals
[@colarusso13]

## OLD

## Labialization

```{r}
df %>% 
  mutate(lab = str_detect(segment, "ʷ")) %>% 
  group_by(lang, source) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_lab = sum(lab),
            labialization = ifelse(n_lab > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, labialization, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$labialization,
            tile = "Stamen.Terrain")
```

Labialization is widely attested in East Caucasian languages, however there are some languages that lost this feature (e. g. in Budukh, [@talibov07]). Unfortunately, sometimes scholars do not put the whole list of labialised consonants attested in a language. After [@catford72] it is worth mentioning that there are several types of labialisation: 

* /w/-labialisation --- this kind of labialization is more or less independent of the main place of articulation. This kind of labialisation is typical for velar and uvular places fricatives and stops;
* /ɥ/-labialisation --- this kind of labialization is typical for pharyngeals. It looks like the tongue body is retracted (due to pharyngeal place of articulation) and raised, that results /ɥ/-like sound;
* /y/-labialisation --- this kind of labialization is typical only for post-alveolars in Abkhaz and Abaza (North Caucasian), but also may be a case for Tabasaran [@kibrik82: 7--8; @kk90: 337] and Aghul [@kk90: 338].

## Geminates/Fortis

```{r}
df %>% 
  filter(segment_type == "consonant") %>% 
  mutate(feature = str_detect(segment, "ː")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            geminates = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, geminates, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$geminates,
            tile = "Stamen.Terrain")
```

Geminated of fortis/lenis destinction attested through all branches of East Caucasian languages except Tsesic. Unfortunately some scholars understand this differently, so sometimes under this label aspirated vs unaspirated disctinction is used.

## Lateral obstruents

```{r}
df %>% 
  mutate(feature = str_detect(segment, "ɬ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            laterals = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, laterals, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$laterals,
            tile = "Stamen.Terrain")
```


Laterals is the clear feature of Andic and Tsezic languages, hover there is one Lezghian language, Archi, where they also were attested. In most cases lateral system is present by fricative ɬ and two affricates tɬ and tɬ'. Sometimes the subsystem even bigger when geminated version are present.

## Labial approximmant vs fricatives

```{r}
df %>% 
  mutate(feature = str_detect(segment, "v")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            labials = ifelse(n_feature > 0, "v", "w")) %>% 
  select(lang, language, idiom, type, labials, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$labials,
            tile = "Stamen.Terrain")
```

The most common labial sound in East Caucasian languages is bilabial **w** that is present in most languages, however in the South Dagestan approximant become a frecative **v**. I also visited the Dargwa village Ayalakab, where I witnessed the bilabial fricative realisation **β**.

## Pharyngealization

```{r}
df %>%  
  mutate(feature = str_detect(segment, "ˤ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            pharyngealization = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, pharyngealization, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$pharyngealization,
            tile = "Stamen.Terrain")
```

Pharyngealization --- is a complex feature that phonetically reallised as a constriction in the pharynx or epiglottis zone. Different scholars used different strategy in describing locus of the pharyngealisation: sometimes it is analysed as a vowel feature [@forker13], sometimes as a consonant feature [@khalilova09] and sometimes as a suprasegmental feature [@kibrik1994a; @moroz19]. It is common that pharyngealisation spreads through the word, hovewer most researchers distinguish core pharyngealised syllable [@kibrik1994a; @talibov07; @moroz19; @belyayev21]. Everything become even more complicated since some East Caucasian languages developed two different types of pharyngealisation [e. g. @belyayev21]. As we can see from the map, pharyngealization is common for central and south Daghestan for languages of Dargic, Lak, Tsezic and Lezgian branches.

## Nasalized vowels

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  mutate(feature = str_detect(segment, "ⁿ")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            nasalization = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, nasalization, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$nasalization,
            tile = "Stamen.Terrain")
```

Nasalised vowels is a comon feature of Andic and Tsezic languages, hovewer some researchers report sporadic final **n**-delition that leads to development of nasalised vowels in other branches (e. g. Bezhta, [@talibov07]).

## Long vowels

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  mutate(feature = str_detect(segment, "ː")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            `long vowels` = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, `long vowels`, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$`long vowels`,
            tile = "Stamen.Terrain")
```


Long vowels are grouped in the North Dagestan, Chechnya and Ingushetia. It is not present in Avar and and South Dagestan. Hovewer there are some cases when they were reported as a result of some intervocal consonant delitions.

## Umlaut vowels

```{r}
df %>% 
  filter(segment_type == "vowel") %>% 
  mutate(feature = str_detect(segment, "[yøæ]")) %>% 
  group_by(lang) %>% 
  mutate(page = str_c(unique(page), sep = ", ", collapse = ", ")) %>% 
  group_by(lang, language, idiom, type, source, page, contributor, date) %>% 
  summarise(n_feature = sum(feature),
            `umlaut vowels` = ifelse(n_feature > 0, "attested", "not attested")) %>% 
  select(lang, language, idiom, type, `umlaut vowels`, source, page, contributor, date) ->
  for_map

map.feature(languages = for_map$lang,
            features = for_map$`umlaut vowels`,
            tile = "Stamen.Terrain")
```

Umlaut vowels are present in the South Dagestan and in Nakh languages. I can speculatively propose that they historically developed from pharyngealisation, but this hypothesis needs to be accurately checked with shared lexicon.

## More features?

* syllable structure?
* vowel harmony?
* acoustic study of stress?